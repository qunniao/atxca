<div id="app" xmlns:v-on="http://www.w3.org/1999/xhtml">
    <div id="head"  >
        <div  style="padding: 10px;">
            <div>
                <label class="cform-control ol-sm-3 control-label no-padding-right" style="margin-left: 20px;">联系人</label>
                <input class="input_style" id="search_name" style="width: 120px">

                <label class="cform-control ol-sm-3 control-label no-padding-right" style="margin-left: 20px;">联系电话</label>
                <input class="input_style" id="search_phone" style="width: 120px">

               <!-- <button type="button" class="btn btn-primary btn-small" style="margin-left: 20px;" v-on:click="findList()">搜索</button>-->
            </div>
            <br/>
            <div>
                <label class="cform-control ol-sm-3 control-label no-padding-right" for="search_date" style="margin-left: 20px;">日期</label>
                <input type="text" class="input_style" value="" id="search_date" >


                <label class="cform-control ol-sm-3 control-label no-padding-right" style="margin-left: 20px;" for="search_time">时间段</label>
                <select class="input_style" id="search_time">
                    <option value="">全部</option>
                    <option value="9:00-10:00">9:00-10:00</option>
                    <option value="9:00-11:00">9:00-11:00</option>
                    <option value="10:00-11:00">10:00-11:00</option>
                    <option value="11:00-12:00">11:00-12:00</option>
                    <option value="12:00-13:00">12:00-13:00</option>
                    <option value="12:00-14:00">12:00-14:00</option>
                    <option value="13:00-14:00">13:00-14:00</option>
                    <option value="14:00-15:00">14:00-15:00</option>
                    <option value="14:00-16:00">14:00-16:00</option>
                    <option value="15:00-16:00">15:00-16:00</option>
                    <option value="16:00-17:00">16:00-17:00</option>
                    <option value="16:00-18:00">16:00-18:00</option>
                    <option value="17:00-18:00">17:00-18:00</option>
                    <option value="18:00-19:00">18:00-19:00</option>
                    <option value="18:00-20:00">18:00-20:00</option>
                    <option value="19:00-20:00">19:00-20:00</option>
                    <option value="20:00-21:00">20:00-21:00</option>
                    <option value="20:00-22:00">20:00-22:00</option>
                    <option value="21:00-22:00">21:00-22:00</option>
                </select>

                <span class="cform-control ol-sm-3 control-label no-padding-right" style="margin-left: 20px;">场馆</span>
                <select id="search_changdi" name="search_changdi" class="input_style">
                    <option value="0">全部</option>
                </select>

                <span class="cform-control ol-sm-3 control-label no-padding-right" style="margin-left: 20px;">订单状态</span>
                <select id="search_state" name="search_state" class="input_style">
                    <option value="0">全部</option>
                    <option value="2">预约成功</option>
                    <option value="7">现金到场</option>
                    <option value="6">支付宝到场</option>
                    <option value="5">预约未到</option>
                    <option value="4">预约失败</option>
                </select>

                <button type="button" class="btn btn-primary" style="margin-left: 20px;" v-on:click="findList()">查询</button>

                <button type="button" id="bdx88" class="btn btn-success " style="margin-left: 50px;">添加预约</button>

                <button type="button" class="btn btn-info" id="refreshOrder" style="float:right;">刷新未到场</button>

            </div>
        </div>

    </div>

    <div class="col-12 maximum-margin">
        <div class="card-body p-0">
            <div class="table">
                <div class="table-header-group" >
                    <ul class="table-row">
                        <li class="table-cell" style="width:150px;">片场名称</li>
                        <li class="table-cell">场馆</li>
                        <li class="table-cell" >联系人</li>
                        <li class="table-cell">联系电话</li>
                        <li class="table-cell" >预约日期</li>
                        <li class="table-cell" >预约时间段</li>
                        <li class="table-cell">价格</li>
                        <li class="table-cell">订单状态</li>
                        <li class="table-cell" style="width:200px;">操作</li>
                    </ul>
                </div>
                <span class="table-row-group">
                    <ul class="table-row" v-for="item in list">
                        <li class="table-cell">{{item.pianchang_name}}</li>
                        <li class="table-cell">{{item.changguan_name}}</li>
                        <li class="table-cell">{{item.name}}</li>
                        <li class="table-cell">{{item.phone}}</li>
                        <li class="table-cell">{{item.reserveTime}}</li>
                        <li class="table-cell">{{item.betTime}}</li>
                        <li class="table-cell">{{item.price}}</li>
                         <li class="table-cell">

                            <span v-if="item.type==2">
                                <span class="label label-warning radius">预约成功</span>
                            </span>
                            <span v-if="item.type==5">
                                <span class="label label-info radius">预约未到</span>
                            </span>
                            <span v-if="item.type==7">
                                <span class="label label-success radius">现金到场</span>
                                <button type="button" class="btn btn-warning btn-sm" v-on:click="printDaYin(item)">打印</button>

                            </span>
                             <span v-if="item.type==6">
                                <span class="label label-success radius">支付宝到场</span>
                                <button type="button" class="btn btn-warning btn-sm" v-on:click="printDaYin(item)">打印</button>

                            </span>
                             <span v-if="item.type==4">
                                <span class="label label-default radius">预约失败</span>
                            </span>

                         </li>

                        <li class="table-cell">

                                <button type="button" class="btn btn-info btn-sm "  v-on:click="updateModal(item.orderId,item.name,item.phone,item.price,item.type)">修改</button>
                                <button type="button" class="btn btn-default btn-sm "  v-on:click="deleteItem(item.oid)">删除</button>

                        </li>
                    </ul>
                </span>
            </div>

        </div>

        <div id="reservationPage2"></div>
    </div>

</div>


<div id="viewPopUp" class="portlet box"></div>

<!--增加模态窗口-->
<div id="reservationModal" class="modal" style="top: 50px">
    <div class="modal-dialog animated">
        <div class="modal-content">


            <div id="dayin">

            <div class="print_container" style="height:550px;width:100%;">

                <div class="section1">
                    <h4 style="text-align: center;">浙江省全民健身中心</h4>
                </div>

                <div class="section2">
                    <label style="font-size:1px;" id="print_dayin_time_1">打印时间：2019-06-25</label>
                </div>
                <span>**************************</span>
                <div class="section4">
                    <div style="border-bottom: 1px solid #DADADA;">
                        <!--<ul>
                            <div>菜单名称     数量    金额</div>
                            <li>米饭米饭 米饭 米饭 米饭 米饭 米饭       2    28元</li>
                            <li>米饭      2    28元</li>
                        </ul>-->
                        <label style="font-size:13px;" id="print_changdi_1">场地名称：篮球馆一号-1号</label>
                        <div class="clearfix"></div>
                        <label style="font-size:13px; " id="print_date_1">预约日期：2019-02-16</label>
                        <div class="clearfix"></div>
                        <label style="font-size:13px;" id="print_time_1">预约时间：15:00-16:00</label>
                        <div class="clearfix"></div>
                        <label style="font-size:13px;" id="print_state_1">预约状态：现金到场</label>
                    </div>
                    <div class="other_fee">
                        <div class="canh">
                            <label class="left">应收</label>
                            <label class="right" id="print_price_1">0 元</label>
                            <div class="clearfix"></div>
                        </div>
                    </div>
                    <div class="total">
                        <label class="left">实收</label>
                        <label class="right" id="print_all_price_1">40 元</label>
                        <div class="clearfix"></div>
                    </div>
                    <div style="width:100%;height:5px;background-color: white"></div>
                    <span>**************************</span>
                </div>
                <div class="section5">
                    <label style="font-size:14px;" id="print_name_1">会员名称：小郭</label>
                    <div class="clearfix"></div>
                    <label style="font-size:14px;" id="print_phone_1">会员电话：15920285509</label>
                </div>
                <span>**************************</span>

                <div class="section5">
                    <label style="font-size:1px;">凭此票入场，请妥善保管</label><div class="clearfix"></div>
                    <label style="font-size:1px;">地址：杭州市体育场路153号</label><div class="clearfix"></div>
                    <label style="font-size:1px;">预约电话：0571-85191653</label><div class="clearfix"></div>
                    <label style="font-size:1px;">谢谢光临，祝您健康</label><div class="clearfix"></div>
                </div>
                <div style="width:100%;height:90px;background-color: white"></div>

            </div>

            <div class="print_container" style="height:550px;width:100%;">
                <div style="width:100%;height:10px;background-color: white"></div>
                <div class="section1">
                    <h4 style="text-align: center;">浙江省全民健身中心</h4>
                </div>
                <div class="section2">
                    <label style="font-size:1px;" id="print_dayin_time_2">打印时间：2019-06-25</label>
                </div>
                <span>**************************</span>
                <div class="section4">
                    <div style="border-bottom: 1px solid #DADADA;">
                        <!--<ul>
                            <div>菜单名称     数量    金额</div>
                            <li>米饭米饭 米饭 米饭 米饭 米饭 米饭       2    28元</li>
                            <li>米饭      2    28元</li>
                        </ul>-->
                        <label style="font-size:13px;" id="print_changdi_2">场地名称：篮球馆一号-1号</label>
                        <div class="clearfix"></div>
                        <label style="font-size:13px; " id="print_date_2">预约日期：2019-02-16</label>
                        <div class="clearfix"></div>
                        <label style="font-size:13px;" id="print_time_2">预约时间：15:00-16:00</label>
                        <div class="clearfix"></div>
                        <label style="font-size:13px;" id="print_state_2">预约状态：现金到场</label>
                    </div>
                    <div class="other_fee">
                        <div class="canh">
                            <label class="left">应收</label>
                            <label class="right" id="print_price_2">0 元</label>
                            <div class="clearfix"></div>
                        </div>
                    </div>
                    <div class="total">
                        <label class="left">实收</label>
                        <label class="right" id="print_all_price_2">40 元</label>
                        <div class="clearfix"></div>
                    </div>
                    <div style="width:100%;height:5px;background-color: white"></div>
                    <span style="color: #8F8F8F">**************************</span>
                </div>
                <div class="section5">
                    <label style="font-size:14px;" id="print_name_2">会员名称：小郭</label>
                    <div class="clearfix"></div>
                    <label style="font-size:14px;" id="print_phone_2">会员电话：15920285509</label>
                </div>
                <span>**************************</span>

                <div class="section5">
                    <label style="font-size:1px;">凭此票入场，请妥善保管</label><div class="clearfix"></div>
                    <label style="font-size:1px;">地址：杭州市体育场路153号</label><div class="clearfix"></div>
                    <label style="font-size:1px;">预约电话：0571-85191653</label><div class="clearfix"></div>
                    <label style="font-size:1px;">谢谢光临，祝您健康</label><div class="clearfix"></div>
                </div>
                <div style="width:100%;height:90px;background-color: white"></div>

            </div>

            <div class="print_container" style="height:550px;width:100%;">
                <div style="width:100%;height:10px;background-color: white"></div>
                <div class="section1">
                    <h4 style="text-align: center;">浙江省全民健身中心</h4>
                </div>
                <div class="section2">
                    <label style="font-size:1px;" id="print_dayin_time_3">打印时间：2019-06-25</label>
                </div>
                <span>**************************</span>
                <div class="section4">
                    <div style="border-bottom: 1px solid #DADADA;">
                        <!--<ul>
                            <div>菜单名称     数量    金额</div>
                            <li>米饭米饭 米饭 米饭 米饭 米饭 米饭       2    28元</li>
                            <li>米饭      2    28元</li>
                        </ul>-->
                        <label style="font-size:13px;" id="print_changdi_3">场地名称：篮球馆一号-1号</label>
                        <div class="clearfix"></div>
                        <label style="font-size:13px; " id="print_date_3">预约日期：2019-02-16</label>
                        <div class="clearfix"></div>
                        <label style="font-size:13px;" id="print_time_3">预约时间：15:00-16:00</label>
                        <div class="clearfix"></div>
                        <label style="font-size:13px;" id="print_state_3">预约状态：现金到场</label>
                    </div>
                    <div class="other_fee">
                        <div class="canh">
                            <label class="left">应收</label>
                            <label class="right" id="print_price_3">0 元</label>
                            <div class="clearfix"></div>
                        </div>
                    </div>
                    <div class="total">
                        <label class="left">实收</label>
                        <label class="right" id="print_all_price_3">40 元</label>
                        <div class="clearfix"></div>
                    </div>
                    <div style="width:100%;height:5px;background-color: white"></div>
                    <span>**************************</span>
                </div>
                <div class="section5">
                    <label style="font-size:14px;" id="print_name_3">会员名称：小郭</label>
                    <div class="clearfix"></div>
                    <label style="font-size:14px;" id="print_phone_3">会员电话：15920285509</label>
                </div>
                <span>**************************</span>

                <div class="section5">
                    <label style="font-size:1px;">凭此票入场，请妥善保管</label><div class="clearfix"></div>
                    <label style="font-size:1px;">地址：杭州市体育场路153号</label><div class="clearfix"></div>
                    <label style="font-size:1px;">预约电话：0571-85191653</label><div class="clearfix"></div>
                    <label style="font-size:1px;">谢谢光临，祝您健康</label><div class="clearfix"></div>
                </div>
                <div style="width:100%;height:20px;background-color: white"></div>
            </div>

            </div>
        </div>
    </div>
</div>

<!--修改模态窗口-->
<div id="updateModal" class="modal" style="top: 50px">
    <div class="modal-dialog animated">
        <div class="modal-content">
            <form class="form-horizontal" method="get" id="modaltests">
                <div class="modal-header">
                    <strong>修改订单</strong>
                </div>

                <div class="modal-body">

                    <div class="form-group">
                        <label class="col-sm-3 control-label no-padding-right" for="userNames">姓名</label>
                        <div class="col-sm-9">
                            <input type="hidden" id="modal_oid" class="form-control">
                            <input type="text" id="userNames" class="form-control">
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="cform-control ol-sm-3 control-label no-padding-right" for="userphones">手机号</label>
                        <div class="col-sm-9">
                            <input type="text" id="userphones" class="form-control">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="cform-control ol-sm-3 control-label no-padding-right" for="prices">价格</label>
                        <div class="col-sm-9">
                            <input type="text" id="prices" class="form-control">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="cform-control ol-sm-3 control-label no-padding-right" for="orderTypes">订单状态</label>
                        <div class="col-sm-9">
                            <select id="orderTypes"
                                    class="form-control col-xs-10 col-sm-6 v_required"
                                    data-toggle="popover"
                                    data-trigger='manual' required>
                                <option value="2">预约成功</option>
                                <option value="7">现金到场</option>
                                <option value="6">支付宝到场</option>
                                <option value="4">预约失败</option>
                            </select>
                            <span class='star'></span>
                        </div>
                    </div>

                    <!--<div class="form-group">-->
                        <!--<label for="vName" class="control-label col-xs-4">名称</label>-->
                        <!--<div class="input-group col-xs-7">-->
                            <!--<input type="text" id="vName" name="vName" class="form-control col-xs-10 col-sm-6" required>-->
                        <!--</div>-->
                    <!--</div>-->

                </div>


                <div class="modal-footer">
                    <button class="btn btn-default" type="button" id="exits22">取消</button>
                    <button class="btn btn-primary" type="button" id="savess22">保存</button>
                </div>
            </form>
        </div>
    </div>
</div>
<!--添加模态窗口-->
<div id="addsModal" class="modal" style="top: 50px">
    <div class="modal-dialog animated">
        <div class="modal-content">
            <form class="form-horizontal" method="get" id="modaltestss">
                <div class="modal-header">
                    <strong>添加新预约</strong>
                </div>

                <div class="modal-body">
                    <div class="form-group">
                        <label class="cform-control col-sm-3 control-label no-padding-right" for="userNames">姓名</label>
                        <div class="col-sm-9">
                            <input type="text" id="ylname" class="form-control">
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="cform-control ol-sm-3 control-label no-padding-right" for="userphones">手机号</label>
                        <div class="col-sm-9">
                            <input type="text" id="ulphone" class="form-control">
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="cform-control ol-sm-3 control-label no-padding-right" for="vhouseid">场馆</label>
                        <div class="col-sm-9">
                            <select id="vhouseid"
                                    class="form-control col-xs-10 col-sm-6 v_required"
                                    data-toggle="popover"
                                    data-trigger='manual' required></select>
                            <span class='star'></span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="cform-control ol-sm-3 control-label no-padding-right" for="venusesid">场地</label>
                        <div class="col-sm-9">
                            <select id="venusesid"
                                    class="form-control col-xs-10 col-sm-6 v_required"
                                    data-toggle="popover"
                                    data-trigger='manual' required></select>
                            <span class='star'></span>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="cform-control ol-sm-3 control-label no-padding-right" for="orderState">订单状态</label>
                        <div class="col-sm-9">
                            <select id="orderState"
                                    class="form-control col-xs-10 col-sm-6 v_required"
                                    data-toggle="popover"
                                    data-trigger='manual' required>
                                <option value="2">预约成功</option>
                                <option value="7">现金到场</option>
                                <option value="6">支付宝到场</option>
                                <option value="4">预约失败</option>
                            </select>
                            <span class='star'></span>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="cform-control ol-sm-3 control-label no-padding-right" for="usertimes">日期</label>
                        <div class="col-sm-9">
                            <input type="text" class="form-control" value="" id="usertimes" style="width: 120px">
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="cform-control ol-sm-3 control-label no-padding-right" for="pbettime">时间段</label>
                        <div class="col-sm-9">
                            <div class="form-group" id="pbettime">

                            </div>
                            <span class='star'></span>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="cform-control ol-sm-3 control-label no-padding-right" >总价</label>
                        <div class="col-sm-9">
                           <span id="money">0元</span>
                        </div>
                    </div>

                    <!--<div class="form-group">-->
                    <!--<label for="vName" class="control-label col-xs-4">名称</label>-->
                    <!--<div class="input-group col-xs-7">-->
                    <!--<input type="text" id="vName" name="vName" class="form-control col-xs-10 col-sm-6" required>-->
                    <!--</div>-->
                    <!--</div>-->

                </div>


                <div class="modal-footer">
                    <button class="btn btn-default" type="button" id="exits23">取消</button>
                    <button class="btn btn-primary" type="button" id="savess23">保存</button>
                </div>
            </form>
        </div>
    </div>
</div>

<script type="text/javascript">
    $.getScript("js/page/reservation.js");
</script>

<script type="text/javascript">
    var app = new Vue({
        el: '#app',
        data: {
            list: [],
            date:"",
            page:1,
            list3:[]
        },
        // 在 `methods` 对象中定义方法
        methods: {
            findList: function () {
                var search_phone = $("#search_phone").val();
                var search_name = $("#search_name").val();
                /*
                if(""!=search_phone){
                    //调用搜索联系电话方法
                    app.findListByPhone(search_phone);
                    return;
                }

                if(""!=search_name){
                    //调用搜索联系人方法
                    app.findListByName(search_name);
                    return;
                }
*/

                var search_date = $('#search_date').val();
                console.log("搜索日期:" + search_date);

                var search_time = $('#search_time').val();
                console.log("搜索时间段:" + search_time);

                var search_changdi = $('#search_changdi').val();
                console.log("搜索场馆:" + search_changdi);

                var search_state = $('#search_state').val();
                console.log("搜索状态:" + search_state);

                var opt = {
                    "phone": search_phone,
                    "name": search_name,
                    "date": search_date,
                    "time": search_time,
                    "changdi": search_changdi,
                    "state": search_state,
                    "page":app.page
                }
                com.post(api.findOrderList, opt, function (res) {
                    app.list = res.payload;
                    console.log(res);
                    console.log("findList callback "+app.list);
                }, function () {
                }, false);



            },
            findListByPhone: function (data) {

                var opt = {
                    "phone":data
                }
                com.post(api.findOrderListByPhone, opt, function (res) {
                    app.list = res.payload;
                    console.log(res);

                }, function () {
                }, false);
            },
            findListByName: function (data) {

                var opt = {
                    "name":data
                }
                com.post(api.findOrderListByName, opt, function (res) {
                    app.list = res.payload;
                    console.log(res);

                }, function () {
                }, false);
            },
            findChangGuanList: function () {

                var opt = {

                }
                com.post(api.findChangGuanList, opt, function (res) {
                    var list = res.payload;
                    console.log(res);
                    //添加select 存放指标id
                    var obj = document.getElementById('search_changdi'); //定位id

                    //空置可预约
                    var n=1;
                    for(var i=0;i<list.length;i++){
                        obj.options[n++] = new Option( list[i].name, list[i].id);
                    }

                }, function () {
                }, false);
            },
            deleteItem: function (id) {
                layer.confirm('确认要删除该订单吗？',function(index){
                    var opt = {
                        "id":id
                    }
                    com.post(api.deleteOrderById, opt, function (res) {
                        console.log(res);
                        app.findList();
                    }, function () {
                    }, false);
                    layer.close(index);
                    // window.location.href="${pageContext.request.contextPath}/store/updateStatus2.html?id="+id+"&status=0";
                });
            },
            updateModal: function(oid,name,phone,price,type) {
                $("#modal_oid").val(oid);
                $("#userNames").val(name);
                $("#userphones").val(phone);
                $("#prices").val(price);
                $("#type").val(type);

                $("#orderTypes").find("option[value='" + type + "']").attr("selected", true);
                $("#updateModal").show();
             },
            printDaYin: function(item) {
                console.log("打印");
                console.log("oid "+item.oid);
                document.getElementById("print_changdi_1").innerHTML="场地名称："+item.changguan_name+"-"+item.pianchang_name;
                document.getElementById("print_changdi_2").innerHTML="场地名称："+item.changguan_name+"-"+item.pianchang_name;
                document.getElementById("print_changdi_3").innerHTML="场地名称："+item.changguan_name+"-"+item.pianchang_name;

                document.getElementById("print_date_1").innerHTML="预约日期："+item.reserveTime;
                document.getElementById("print_date_2").innerHTML="预约日期："+item.reserveTime;
                document.getElementById("print_date_3").innerHTML="预约日期："+item.reserveTime;

                document.getElementById("print_time_1").innerHTML="预约时间："+item.betTime;
                document.getElementById("print_time_2").innerHTML="预约时间："+item.betTime;
                document.getElementById("print_time_3").innerHTML="预约时间："+item.betTime;

                document.getElementById("print_price_1").innerHTML=item.price+" 元";
                document.getElementById("print_price_2").innerHTML=item.price+" 元";
                document.getElementById("print_price_3").innerHTML=item.price+" 元";

                document.getElementById("print_all_price_1").innerHTML=item.price+" 元";
                document.getElementById("print_all_price_2").innerHTML=item.price+" 元";
                document.getElementById("print_all_price_3").innerHTML=item.price+" 元";

                document.getElementById("print_name_1").innerHTML="会员名称："+item.name;
                document.getElementById("print_name_2").innerHTML="会员名称："+item.name;
                document.getElementById("print_name_3").innerHTML="会员名称："+item.name;

                document.getElementById("print_phone_1").innerHTML="会员电话："+item.phone;
                document.getElementById("print_phone_2").innerHTML="会员电话："+item.phone;
                document.getElementById("print_phone_3").innerHTML="会员电话："+item.phone;

                if(item.type==7){
                    document.getElementById("print_state_1").innerHTML="预约状态：现金到场";
                    document.getElementById("print_state_2").innerHTML="预约状态：现金到场";
                    document.getElementById("print_state_3").innerHTML="预约状态：现金到场";
                }
                if(item.type==6){
                    document.getElementById("print_state_1").innerHTML="预约状态：支付宝到场";
                    document.getElementById("print_state_2").innerHTML="预约状态：支付宝到场";
                    document.getElementById("print_state_3").innerHTML="预约状态：支付宝到场";
                }

                var myDate = new Date();
                var year = myDate.getFullYear();
                var month = myDate.getMonth()+1;
                var day = myDate.getDate();
                var hour = myDate.getHours();
                var min = myDate.getMinutes();
               // var seconds = myDate.getSeconds();

                if(month < 10)month="0"+month;
                if(day < 10)day="0"+day;
                var date = year+"-"+month+"-"+day+" "+hour+":"+min;        //获取当前年份(4位)

                console.log("打印日期:"+date);
                document.getElementById("print_dayin_time_1").innerHTML="打印时间："+date;
                document.getElementById("print_dayin_time_2").innerHTML="打印时间："+date;
                document.getElementById("print_dayin_time_3").innerHTML="打印时间："+date;

              //  $("#reservationModal").show();

               $("#dayin").jqprint({operaSupport: false});
               // viewToWord("房间：903\r\n栋号：6\r\n楼层：9\r\n户型\r\n时间：2011年9月16日");
            }
        }
    })
    app.findList();
    app.findChangGuanList();



    var wdapp;
    var wddoc;
    function viewToWord(str) {
        try {
            // 创建ActiveXObject对象
            wdapp = new ActiveXObject("Word.Application");
        }
        catch (e) {
            /*
                           * 如果抛异常，请检查一下几点：
                           * 1.确保机器已安装Office;
                           * 2.已将本系统的站点名加入到IE的信任站点列表中;
                           * 3.参考下文设置浏览器的安全;
                           * 4.这是微软的东西只能在ie下才能运行;
                           * 5.尊重别人的成果，仔细阅读每一个关键点。
                           */
            console.log("无法调用Office对象，！", e)
            wdapp = null;
            return;
        }
        wdapp.Documents.Open("f:\\PrinterTemplate.doc"); //打开本地(客户端)word模板
        wddoc = wdapp.ActiveDocument;
        wddoc.Bookmarks("Title").Range.Text = "要打印的标题";//找到Word中的Title标签，替换其内容
        wddoc.Bookmarks("Content").Range.Text = str;
        //wdapp.ActiveDocument.ActiveWindow.View.Type = 1;
        wdapp.visible = false; //word模板是否可见
        wddoc.saveAs("f:\\print\\PrinterTemp.doc"); //保存临时文件word
        wdapp.Application.Printout(); //调用自动打印功能

        wdapp.quit();
        wdapp = null;
    }

    function cancelMotai(){
        console.log("cancelMotai");
        $("#editStateModal").hide();
    }

    //添加显示模态框
    $("#bdx88").click(function () {
        var list1 = null;
        var list2 = null;
        //获取场馆列表
        com.post(api.queryVhouseALL, null, function (res) {
            list1 = res.data.content;
        }, function () {
        }, false);
        $("#vhouseid").bindData(list1, "id", "name", false);

        //获取片场列表
        console.log("id:"+list1[0].id);
        var opt = {
            "id": list1[0].id
        }
        var list = null;
        com.post(api.findPianChangList2, opt, function (res) {
            list = res.payload;
            console.log(res.payload);
            //添加select 存放指标id
            var obj = document.getElementById('venusesid'); //定位id

            //空置可预约
            var n=0;
            for(var i=0;i<list.length;i++){
                obj.options[n++] = new Option( list[i].vname, list[i].vid);
            }

        }, function () {
        }, false);




        //$("#pbettime").bindData(list3, "pid", "betTime", false);
        //首先找到Id为d的元素
        console.log("list1[0]:"+list1[0].id);
        var opt = {
            "id": list1[0].id
        }
        com.post(api.findPeriodTimeListById, opt, function (res) {
            app.list3 = res.payload;
        }, function () {
        }, false);
        console.log("list3:"+app.list3);
        var d=document.getElementById('pbettime');
        d.innerHTML="";
        for(var i=0;i<app.list3.length;i++){
            //创建一个节点
            var a=document.createElement('input');
            a.type="checkbox";
            a.name="type"+app.list3[i].pid;
            a.id="type"+app.list3[i].pid;
            a.value=app.list3[i].pid;
            //a.style="margin-right:20px";
            d.appendChild(a);

            var b=document.createElement('span');
            b.innerHTML=app.list3[i].betTime;
            b.setAttribute("class","type_span");
            b.style="margin-right:20px";
            d.appendChild(b);
        }

        var name = $("#ylname").val(null);
        var phone = $("#ulphone").val(null);
        var price = $("#userprice").val(null);
       // var usertimes = $("#usertimes").val(null);
        var myDate = new Date();
        var year = myDate.getFullYear();
        var month = myDate.getMonth()+1;
        var day = myDate.getDate();
        if(month < 10)month="0"+month;
        if(day < 10)day="0"+day;
        var date = year+"-"+month+"-"+day;        //获取当前年份(4位)

        $("#usertimes").val(date);

        $("#addsModal").show();
    });

    //添加显示模态框
    $("#savess23").click(function () {
        console.log("保存!!!!!!");

        var name = $("#ylname").val();
        if(""==name){
            alert("请输入姓名");
            return;
        }
        var phone = $("#ulphone").val();
        if(""==name){
            alert("请输入电话号码");
            return;
        }
        var pid="";
        for(var i=0;i<app.list3.length;i++){
            var item = document.getElementById("type"+app.list3[i].pid);
            if(null == item)continue;
            var check = document.getElementById("type"+app.list3[i].pid).checked;
            console.log(check.checked);//false
            if(!check)continue;
            pid+=$("#type"+app.list3[i].pid).val()+",";
        }
        console.log("pid:"+pid);


        var usertimes = $("#usertimes").val();
        if(""==usertimes){
            alert("请选择日期");
            return;
        }

        if(""==pid){
            alert("请选择时间段");
            return;
        }

        var venusesid = $("#venusesid").val();
        console.log("场地id："+venusesid);
        var opt = {
            "name": name,
            "phone": phone,
            "pids": pid,
            "reserveTime": usertimes,
            "vid":venusesid,
            "type":$("#orderState").val()
        }


        com.post(api.createOrder, opt, function (res) {
            layer.msg(res.msg);
            if(res.code==200){
                $("#addsModal").hide();
                app.findList();
            }

        }, function () {
        }, false)


    });
    $("#exits22").click(function () {
        $("#updateModal").hide();
    });
    $('#usertimes').fdatepicker({
        format: 'yyyy-mm-dd'

    });


    $('#vhouseid').change(function () {
        var id = $('#vhouseid').val();
        console.log("vhouseid:"+id);
        $('#venusesid').empty();
        $('#pbettime').empty();

        //获取片场列表
        var opt = {
            "id": id
        }
        var list = null;
        com.post(api.findPianChangList2, opt, function (res) {
            list = res.payload;

            //添加select 存放指标id
            var obj = document.getElementById('venusesid'); //定位id

            var n=0;
            for(var i=0;i<list.length;i++){
                obj.options[n++] = new Option( list[i].vname, list[i].vid);
            }

        }, function () {
        }, false);

        $("#pbettime").bindData(app.list3, "pid", "betTime", false);



        app.list3=null;
        var opt = {
            "id": id
        }
        com.post(api.findPeriodTimeListById, opt, function (res) {
            app.list3 = res.payload;
        }, function () {
        }, false);
        console.log("list3:"+app.list3);
        var d=document.getElementById('pbettime');
        d.innerHTML="";
        for(var i=0;i<app.list3.length;i++){
            //创建一个节点
            var a=document.createElement('input');
            a.type="checkbox";
            a.name="type"+app.list3[i].pid;
            a.id="type"+app.list3[i].pid;
            a.value=app.list3[i].pid;
            //a.style="margin-right:20px";
            d.appendChild(a);

            var b=document.createElement('span');
            b.innerHTML=app.list3[i].betTime;
            b.setAttribute("class","type_span");
            b.style="margin-right:20px";
            d.appendChild(b);



        }

    });

    $('#pbettime').click(function () {
        checkMoney();
    });



    function checkMoney() {
        console.log("checkMoney");

        var value = $("#usertimes").val().trim();
        console.log("日期："+value);
        if (value == "") {
            return;
        }
        var day = new Date(value).getDay();
        console.log("day："+day);

        var money=0;
        for(var i=0;i<app.list3.length;i++){
            var check = document.getElementById("type"+app.list3[i].pid).checked;
            console.log("check:"+check.checked);//false
            if(!check)continue;

            var text="";
            switch (day) {

                case 1:
                    text = "星期一";
                case 2:
                    text = "星期二";
                case 3:
                    text = "星期三";
                case 4:
                    text = "星期四";
                case 5:
                    text = "星期五";
                    money += app.list3[i].price;
                    console.log("星期几:" + text);
                    break;
                case 6:
                    text = "星期六";
                case 0:
                    text = "星期日";
                    money += app.list3[i].weekPrice;
                    console.log("星期几2:" + text);
                    break;
            }
        }
        console.log("money:"+money);
        $("#money").text(money+"元");
    }
    //保存编辑
    $("#savess22").click(function () {
        console.log("保存编辑")
        var userName = $("#userNames").val();
        var userphone = $("#userphones").val();
        var price = $("#prices").val();
        var orderTypes = $("#orderTypes").val();
        var opt = {
            name: userName,
            phone: userphone,
            price: price,
            type: orderTypes,
            orderId: $("#modal_oid").val()
        };

        com.post(api.updateOrder, opt, function (res) {
            $("#updateModal").hide();
            app.findList();
        }, null, false)

    });
    //添加
    $("#exits23").click(function () {
        $("#addsModal").hide();
    });

    $("#search_date").fdatepicker({
        format: 'yyyy-mm-dd'
    });

    $("#refreshOrder").click(function () {
        var opt = {
        };
        com.post(api.refreshOrder, opt, function (res) {
            app.findList();
            layer.msg(res.msg,{time:5*1000});
        }, null, false)
    });



</script>


